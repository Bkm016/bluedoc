<% title_tag @issue.title, @repository.name %>

<%= render "menu" %>

<div id="issue-<%= @issue.id %>" class="issue-box">
  <div class="issue-heading">
    <%= link_to t(".New Issue"), new_user_repository_issue_path(@user, @repository), class: "btn btn-primary float-right" %>
    <h1><%= @issue.title %><span class="issue-iid">#<%= @issue.iid %></span></h1>
    <div class="issue-info">
      <span class="author"><%= user_name_tag(@issue.user) %></span>
      <span class="created-at"><%= t("created at") %> <%= timeago @issue.created_at %></span>
      <a class="ml-3" href="#comment"><%= @issue.comments_count %> <%= t(".comments") %></a>
    </div>
  </div>

  <div class="flex-wrap">
    <div class="col-12 col-md-8">
      <div class="info">
      </div>
      <div class="markdown-body">
        <%= raw @issue.body_html %>
      </div>

      <div class="doc-reaction issue-reaction">
        <%= render "/reactions/reactions", subject: @issue, reactions: @issue.reactions %>
      </div>

      <% if @comments %>
      <div class="issue-comments mt-3 clearfix" id="comment">
        <%= render "/comments/comments", commentable: @issue, comments: @comments %>
      </div>
      <% end %>
    </div>

    <div class="col-12 col-md-3">
      <%= react_component "issues/Sidebar", { issueURL: @issue.to_path, assignees: @issue.assignees.collect(&:as_item_json), assigneeTargets: @issue.assignee_target_users.collect(&:as_item_json) } %>
    </div>
  </div>
</div>