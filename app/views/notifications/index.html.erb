<div class="col-12 clearfix">
  <div class="col-3 v-align-top pr-4 float-left">
    <ul class="menu">
      <%= render_list_items(class: "menu-item", type: :link, check_parameters: true) do |li|
        li << link_to(main_app.notifications_path, class: "menu-item") do %>
          Unread<span class="Counter"><%= unread_notifications_count %></span>
        <% end
        li << link_to("All", main_app.notifications_path(tab: "all"), class: "menu-item")
      end %>
    </ul>
  </div>

  <div class="col-9 v-align-top float-left">
    <div class="notifications Box">
      <div class="Box-header clearfix">
        <span class="float-right">
          <% if params[:tab] == "all" %>
            <%= link_to "Clear all", main_app.clean_notifications_path, class: 'btn btn-sm btn-danger', method: 'delete' %>
          <% else %>
            <%= form_with scope: :notification, url: main_app.read_notifications_path, method: :post do |form| %>
              <% @notifications.each do |note| %>
              <input type="hidden" name="ids[]" value="<%= note.id %>">
              <% end %>
              <button type="submit" class="btn btn-sm">Mark as read</button>
            <% end %>
          <% end %>
        </span>

        <span class="title">
          <% if params[:tab] == "all" %>All<% else %>Unread<% end %> notifications
        </span>
      </div>
      <div class="list">
        <% if @notifications.blank? %>
          <div class="blankslate m-4">
            You does not have any <% if params[:tab] != "all" %>unread<% end %> notifications.
          </div>
        <% else %>
          <%= render @notifications %>
        <% end %>
      </div>
    </div>
    <%= paginate @notifications, params: { controller: "notifications", action: "index" } %>
  </div>
</div>

<script>
  $(".notifications").on("click", ".notification", function(e) {
    e.stopPropagation();
    $note = $(e.currentTarget);
    $note.removeClass("unread");
    Turbolinks.visit("/notifications/" + $note.attr('data-id'));
    return false;
  })
</script>